# Инструкция по развертыванию DropDPI

Эта инструкция описывает, как настроить DropDPI на двух серверах (или одном VPS и локальном компьютере) для обхода блокировок.

**Схема работы:**
`Ваш ПК (Клиент) <--> Зашифрованный WSS туннель <--> VPS (Сервер) <--> Интернет`

---

## Часть 1. Настройка Сервера (VPS)

Это компьютер, который находится в "свободном" интернете (за границей).

### 1. Подготовка файлов
Вам понадобится только один файл: `server_linux` (из папки `bin/`). Загрузите его на сервер.

### 2. Установка
Зайдите на сервер по SSH и выполните следующие команды:

```bash
# 1. Создайте папку для конфигов (опционально, но рекомендуется)
sudo mkdir -p /etc/dropdpi

# 2. Переместите бинарник в системную папку
sudo mv server_linux /usr/local/bin/dropdpi-server
sudo chmod +x /usr/local/bin/dropdpi-server

# 3. Создайте конфиг файл
sudo nano /etc/dropdpi/config.json
```

Вставьте в файл `config.json` следующее содержимое:
```json
{
  "server_listen": ":443",
  "key": "0123456789abcdef0123456789abcdef",
  "fake_page": ""
}
```
*   `server_listen`: Порт, на котором будет висеть сервер. Рекомендуется `:443` (HTTPS) для лучшей маскировки.
*   `key`: Придумайте свой ключ (32 символа) и сохраните его! Он нужен будет для клиента.

### 3. Запуск (как служба)
Чтобы сервер работал всегда и перезапускался автоматически:

1.  Создайте файл службы:
    ```bash
    sudo nano /etc/systemd/system/dropdpi.service
    ```
2.  Вставьте:
    ```ini
    [Unit]
    Description=DropDPI Server
    After=network.target

    [Service]
    Type=simple
    ExecStart=/usr/local/bin/dropdpi-server -config /etc/dropdpi/config.json
    Restart=always
    User=root

    [Install]
    WantedBy=multi-user.target
    ```
3.  Активируйте и запустите:
    ```bash
    sudo systemctl daemon-reload
    sudo systemctl enable --now dropdpi
    ```

**Всё! Сертификаты сгенерируются автоматически при первом запуске.**

---

## Часть 2. Настройка Клиента

Это ваш компьютер или второй сервер в "зацензуренной" зоне.

### 1. Подготовка файлов
Вам понадобится файл `client` (macOS) или `client_linux` (Linux).

### 2. Конфигурация
Создайте рядом с файлом клиента файл `config.json`:

```json
{
  "server_address": "IP_ВАШЕГО_VPS:443",
  "client_listen": "127.0.0.1:1080",
  "key": "0123456789abcdef0123456789abcdef"
}
```
*   `server_address`: Укажите реальный IP вашего VPS из первой части.
*   `key`: Тот же самый ключ, что и на сервере.

### 3. Запуск
Запустите клиент в терминале:
```bash
./client
```
Вы увидите сообщение: `SOCKS5 Client listening on 127.0.0.1:1080`.

---

## Часть 3. Использование

Теперь у вас есть локальный SOCKS5 прокси.

1.  Откройте настройки браузера или системы.
2.  Найдите раздел "Прокси-сервер".
3.  Укажите:
    *   **Тип:** SOCKS5
    *   **Хост:** 127.0.0.1
    *   **Порт:** 1080
4.  Готово! Весь трафик теперь идет через зашифрованный туннель.

### Проверка маскировки
Если вы попробуете открыть IP вашего сервера в браузере (`https://IP_ВАШЕГО_VPS`), вы увидите обычную страницу "Welcome to nginx!". Это значит, что маскировка работает, и для цензора ваш сервер выглядит как обычный сайт.
